<!-- Copyright (c) 2018, XJ Music Inc. (https://xj.io) All Rights Reserved. -->

<div class="headline container-fluid">
  <div class="row">
    <div class="col-sm-12">

      <!-- Entity type and ID -->
      <div class="entity">
        Chain
        #{{model.id}}
        <div class="badge {{lowercase model.state}}-state">{{model.state}}</div>
      </div>

      <!-- Title -->
      <h1>
        {{model.name}}
        <!-- should only show following edit icon if user has privileges to edit this chain -->
        <small>
          {{entity-actions "accounts.one.chains.one" "edit|destroy" model.account model.id}}
        </small>
        &lpar;{{model.state}}&rpar;
      </h1>

      <!-- Time -->
      <p class="detail time">
        from <strong>{{model.startAt}}</strong>
        {{#if model.stopAt}}
          to <strong>{{model.stopAt}}</strong>
        {{/if}}
      </p>

    </div>
  </div>
  <div class="row pb-3">

    <!-- State Change -->
    <div class="col-sm-12 col-md-6 col-lg-6 col-xl-4">
      <div class="chain-state-container container-fluid {{lowercase model.state}}-state">
        <table>
          <tbody>
          <tr class="row">
            <th class="align-middle">
              {{capitalize model.state}}
            </th>
            <td>
              {{chain-state-change model submit=(action "chainsUpdated")}}
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Play Chain -->
    {{#if (or (eq model.state "Fabricate") (eq model.state "Complete"))}}
      <div class="col-sm-12 col-md-6 col-lg-4 col-xl-3">
        <div class="{{if (eq player.currentChain.id model.id)
                         'now-playing'}} play-chain container-fluid">
          <table>
            <tbody>
            <tr class="row">
              {{#if (eq player.currentChain.id model.id)}}
                <th class="align-middle">
                  {{player.state}}
                </th>
                <td>
                  {{#if (eq player.state "Playing")}}
                    <button class="stop" {{action "stop"}}><!--Stop-->&#9640;</button>
                  {{/if}}
                </td>
              {{else}}
                <th class="align-middle">
                  Play
                </th>
                <td>
                  <button type="button" aria-label="play chain #{{model.id}}"
                          class="btn btn-success link-play" {{action 'play' model}}>
                    <!--Play-->&#9658;
                  </button>
                </td>
              {{/if}}
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    {{/if}}
  </div>
</div>

<!-- Upper Container -->
<div class="form-horizontal container-fluid">

  <!-- Segments to actions -->
  <div class="form-group row">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        {{#link-to 'accounts.one.chains.one.segments' model class='nav-link' class='nav-link'}}Segments{{/link-to}}
      </li>
      <li class="nav-item">
        &nbsp;
      </li>
      <li class="nav-item">
        {{#link-to 'accounts.one.chains.one.configs' model class='nav-link' class='nav-link'}}Configs{{/link-to}}
      </li>
      <li class="nav-item">
        {{#link-to 'accounts.one.chains.one.bindings' model class='nav-link' class='nav-link'}}Bindings{{/link-to}}
      </li>
    </ul>
  </div>

</div>

<!-- Inner Content -->
{{outlet}}