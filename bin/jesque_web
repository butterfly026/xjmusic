#!/usr/bin/env bash

TITLE="Elastic Beanstalk Container Setup"
USAGE="
   Usage:
     bin/jesque_web

   Expects an environment variable APPS
   which is a space-separated list of apps to run.
   For example:

     APPS=\"hub\"
       operates only the Hub frontend

     APPS=\"nexus\"
       operates the Nexus client
"

AS_USER="webapp"
AS_GROUP="webapp"
FOLDER_PERMS=755

#
create_folder () {
  PATH="${1}"
  mkdir -p "${PATH}"
  chown ${AS_USER}:${AS_GROUP} "${PATH}"
  chmod ${FOLDER_PERMS} "${PATH}"
  printf "\nCreated ${PATH} owned by ${AS_USER}:${AS_GROUP} with perms ${FOLDER_PERMS}\n"
}

#
create_folders () {
  APP="${1}"
  create_folder "/var/log/${APP}"
  create_folder "/var/cache/${APP}"
}

# for all apps
for APP in ${APPS}; do
  create_folders "${APP}"
done
