// Copyright (c) XJ Music Inc. (https://xj.io) All Rights Reserved.

plugins {
  id 'application'
  id 'distribution'
  id 'jacoco'
  id 'java'
  //
  id "org.flywaydb.flyway" version "7.5.4" apply false
  id "org.openapi.generator" version "4.2.2" apply false
  id 'com.commercehub.gradle.plugin.avro' version '0.9.1'
  id 'com.google.cloud.tools.jib' version '3.1.1' apply false
  id 'de.undercouch.download' version "4.0.4"
  id 'nu.studer.jooq' version '6.0.1' apply false
  id 'org.ajoberstar.grgit' version '4.1.0'
  id 'org.sonarqube' version '2.8'
}

allprojects {
  group = 'io.xj'

  sonarqube {
    properties {
      property 'sonar.sourceEncoding', 'UTF-8'
      property 'sonar.coverage.jacoco.xmlReportPaths', 'build/reports/jacoco/test/jacocoTestReport.xml'
      property 'sonar.jacoco.reportPaths', null
      property 'sonar.jacoco.reportPath', null
      property "sonar.host.url", "https://sonarcloud.io"
    }
  }

  tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
  }
}

subprojects {
  apply plugin: 'java'

  repositories {
    mavenLocal()
    maven {
      name = 'ajoberstar-backup'
      url = 'https://ajoberstar.org/bintray-backup/'
    }
    maven {
      url = 'https://repo.maven.apache.org/maven2'
    }
    maven {
      url = 'https://packages.confluent.io/maven/'
    }
  }

  java {
    sourceCompatibility = JavaVersion.VERSION_16
    targetCompatibility = JavaVersion.VERSION_16
  }
}

